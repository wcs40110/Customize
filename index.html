<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SVG Text Generator</title>
<style>
  * { box-sizing: border-box; }

  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background: #f4f4f4;
    color: #333;
  }

  .generator-container {
    max-width: 700px;
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  .form-group {
    margin-bottom: 15px;
  }

  label {
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
  }

  input, select, textarea, button {
    width: 100%;
    padding: 10px;
    font-size: 1em;
    border: 1px solid #ccc;
    border-radius: 6px;
  }

  button {
    background-color: #333;
    color: white;
    cursor: pointer;
  }

  button:hover {
    background-color: #555;
  }

  #svgPreview {
    margin-top: 20px;
    border: 1px solid #ccc;
    border-radius: 8px;
    background: #fff;
    width: 100%;
    height: auto;
    min-height: 150px;
    text-align: center;
    padding: 10px;
  }

  #popupOverlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.6);
    display: none;
    justify-content: center;
    align-items: center;
    font-size: 1.4em;
    color: white;
    z-index: 1000;
  }

  @media (max-width: 480px) {
    body {
      padding: 10px;
    }
    .generator-container {
      padding: 15px;
    }
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js"></script>
</head>
<body>

<div class="generator-container">
  <h1>Custom SVG Text Generator</h1>
  <form id="customForm" onsubmit="event.preventDefault(); handleSubmit();">
    <div class="form-group">
      <label for="customerInput">Customer Name *</label>
      <input type="text" id="customerInput" required />
    </div>

    <div class="form-group">
      <label for="descInput">Item Description *</label>
      <input type="text" id="descInput" required />
    </div>

    <div class="form-group">
      <label for="locationInput">Engraving Location *</label>
      <input type="text" id="locationInput" required />
    </div>

    <div class="form-group">
      <label for="textInput">Text to Engrave *</label>
      <textarea id="textInput" rows="2" required></textarea>
    </div>

    <div class="form-group">
      <label for="fontSelector">Choose Font *</label>
      <select id="fontSelector" required>
        <option value="Satisfy">Satisfy</option>
        <option value="Righteous">Righteous</option>
        <option value="Grand Hotel">Grand Hotel</option>
        <option value="Short Stack">Short Stack</option>
        <option value="Love Ya Like A Sister">Love Ya Like A Sister</option>
        <option value="Ribeye Marrow">Ribeye Marrow</option>
      </select>
    </div>

    <button type="submit">Generate & Download SVG</button>
  </form>

  <div id="svgPreview">SVG preview will appear here...</div>
</div>

<div id="popupOverlay" onclick="this.style.display='none'">
  SVG downloaded! Click anywhere to dismiss.
</div>

<script>
const fontUrls = {
  "Satisfy": "https://tiny-florentine-e8dbd9.netlify.app/satisfy-regular.woff2",
  "Righteous": "https://tiny-florentine-e8dbd9.netlify.app/righteous-v17-latin-regular.woff2",
  "Grand Hotel": "https://tiny-florentine-e8dbd9.netlify.app/grand-hotel-v19-latin-regular.woff2",
  "Short Stack": "https://tiny-florentine-e8dbd9.netlify.app/short-stack-v15-latin-regular.woff2",
  "Love Ya Like A Sister": "https://tiny-florentine-e8dbd9.netlify.app/love-ya-like-a-sister-v22-latin-regular.woff2",
  "Ribeye Marrow": "https://tiny-florentine-e8dbd9.netlify.app/ribeye-marrow-v24-latin-regular.woff2"
};

let loadedFont = null;
let currentFontName = null;

async function loadFont(fontName) {
  if (fontName === currentFontName && loadedFont) return;
  const url = fontUrls[fontName];
  loadedFont = await opentype.load(url);
  currentFontName = fontName;
}

function generateSvgPath(text, font, size = 80) {
  const path = font.getPath(text, 0, size, size);
  return path.toPathData(2);
}

function generateSvg(text, fontName) {
  if (!loadedFont) return "Loading font...";
  const fontSize = 80;
  const width = 600;
  const height = 150;
  const pathData = generateSvgPath(text, loadedFont, fontSize);
  const textWidth = loadedFont.getAdvanceWidth(text, fontSize);
  const x = (width - textWidth) / 2;
  const y = (height / 2) + (fontSize / 3);

  return `
    <svg xmlns="http://www.w3.org/2000/svg" width="${width}" height="${height}" viewBox="0 0 ${width} ${height}">
      <g transform="translate(${x}, ${y})">
        <path d="${pathData}" fill="#333" />
      </g>
    </svg>
  `;
}

async function updatePreview() {
  const text = document.getElementById('textInput').value.trim();
  const fontName = document.getElementById('fontSelector').value;
  if (!text) {
    document.getElementById('svgPreview').innerHTML = "Enter text above to preview.";
    return;
  }
  await loadFont(fontName);
  document.getElementById('svgPreview').innerHTML = generateSvg(text, fontName);
}

async function handleSubmit() {
  const customer = document.getElementById('customerInput').value.trim();
  const desc = document.getElementById('descInput').value.trim();
  const location = document.getElementById('locationInput').value.trim();
  const text = document.getElementById('textInput').value.trim();
  const fontName = document.getElementById('fontSelector').value;

  if (!customer || !desc || !location || !text) {
    alert("Please fill in all fields.");
    return;
  }

  await loadFont(fontName);
  const svg = generateSvg(text, fontName);
  const filename = `${[customer, desc, location].map(v => v.replace(/\s+/g, "_").replace(/[^\w.-]/g, '')).join("_")}.svg`;

  const blob = new Blob([svg], { type: 'image/svg+xml' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);

  document.getElementById('popupOverlay').style.display = 'flex';
}

document.getElementById('textInput').addEventListener('input', updatePreview);
document.getElementById('fontSelector').addEventListener('change', updatePreview);
window.addEventListener('DOMContentLoaded', () => {
  document.getElementById('fontSelector').value = "Satisfy";
  updatePreview();
});
</script>

</body>
</html>
